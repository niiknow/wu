/*!
 *  wu.js - v0.1.3
 *  build: Mon Apr 03 2017 10:01:26 GMT-0500 (CDT)
 *  web utils
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Wu",[],e):"object"==typeof exports?exports.Wu=e():t.Wu=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return void 0===t||null===t?e:t}function o(){var t=b,e=t.indexOf("MSIE "),n=t.indexOf("Trident/"),r=t.indexOf("rv:");return e>0?parseInt(t.substring(e+5,t.indexOf(".",e)),10):n>0&&parseInt(t.substring(r+3,t.indexOf(".",r)),10)}function a(t,e){function n(){void 0!==this.readyState&&"complete"!==this.readyState||"function"==typeof e&&e()}var r=void 0;t.indexOf("//")<0&&(t="http:"+t),"file"===(s.location||{}).protocol&&(t=t.replace("https://","http://")),r=this.doc.createElement("script"),r.type="text/javascript",r.src=t,e&&(r.onload=n,r.onreadystatechange=n),this.doc.body.appendChild(r)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s={navigator:{userAgent:""},location:{protocol:"file"}},l={},c=Array.prototype,h=Object.prototype,d=c.slice,f=h.hasOwnProperty,v=c.forEach,p=c.map,y=c.some,g=c.indexOf,m=Object.keys,b=s.navigator.userAgent;"undefined"!=typeof window&&(s=window);var k=function(){function t(){r(this,t),this._name="Wu",this.browser={isIE:o(),isMobile:/iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/gi.test(b),isAndroid:/(android)/gi.test(b),isIOS:/iP(hone|od|ad)/gi.test(b)},this.isNull=i,this.win=s,this.doc=document||{},this.forEach=this.each,this.collect=this.map,this.any=this.some,this.getAttribute=this.getAttr,this.setAttribute=this.setAttr}return u(t,[{key:"addEvent",value:function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent(e,n):this.getAttr(t,"on"+e)?t["on"+e]=n:t[e]=n,this}},{key:"removeEvent",value:function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent(e,n):this.getAttr(t,"on"+e)?t["on"+e]=null:t[e]=null,this}},{key:"geoDistance",value:function(t,e,n,r,i){function o(t){return t*Math.PI/180}i=i||{};var a={latitude:t,longitude:e},u={latitude:n,longitude:r},s={km:6371,mile:3960,meter:6371e3,nmi:3440},l=i.unit in s?s[i.unit]:s.km,c=o(u.latitude-a.latitude),h=o(u.longitude-a.longitude),d=o(a.latitude),f=o(u.latitude),v=Math.sin(c/2)*Math.sin(c/2)+Math.sin(h/2)*Math.sin(h/2)*Math.cos(d)*Math.cos(f),p=2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v));return i.threshold?i.threshold>l*p:l*p}},{key:"geoOrderByOrigin",value:function(t,e){var n=this,r=[];return this.each(e,function(e){var i=n.distance(t.Latitude,t.Longitude,e.Latitude,e.Longitude,{unit:"mile"}),o={point:e,distance:parseFloat(n.isNull(i,0)).toFixed(2)};r.push(o)}),this.sortOn(r,"distance"),r}},{key:"getAjaxObject",value:function(){return"XMLHttpRequest"in window?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP")}},{key:"getAttr",value:function(t,e){var n=t[0]||t;return n.getAttribute?n.getAttribute(e):n[e]}},{key:"getAttrs",value:function(t,e){var n=this,r={};return this.each(["","data-"],function(i,o){n.each(e||[],function(e,o){var a=n.getAttr(t,i+o);a&&(r[o]=a)})}),r}},{key:"setAttr",value:function(t,e,n){var r=t[0]||t;return r.setAttribute?r.setAttribute(e,n):r[e]=n,r}},{key:"contains",value:function(t,e){return null!==this.isNull(t,null)&&(g&&t.indexOf===g?t.indexOf(e)!==-1:this.any(t,function(t){return t===e}))}},{key:"createiFrame",value:function(t,e){var n=this.doc.createElement("iframe");return t&&(n.id=t),e&&(n.className=e),n.frameBorder="0",n.marginWidth="0",n.marginHeight="0",n.setAttribute("border","0"),n.setAttribute("allowtransparency","true"),n.width="100%",n.height="100%",n}},{key:"del",value:function(t,e){t[e]=void 0;try{delete t[e]}catch(r){var n={};return this.each(t,function(t,r){r!==e&&(n[r]=t)}),n}return t}},{key:"each",value:function(t,e,n){if(null!==this.isNull(t,null))if(v&&t.forEach===v)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,i=t.length;r<i;r++)if(e.call(n,t[r],r,t)===l)return}else for(var o=this.keys(t),a=0,u=o.length;a<u;a++)if(e.call(n,t[o[a]],o[a],t)===l)return}},{key:"extend",value:function(t){var e=this;return this.each(d.call(arguments,1),function(n){void 0!==n&&e.each(n,function(n,r){null!==e.isNull(n,null)&&(t[r]=n)})}),t}},{key:"groupBy",value:function(t,e,n){var r=this;if(null===this.isNull(t,null))return[];var i=[],o={};this.each(t,function(t){var n=t[e],i=o[n];null===r.isNull(i,null)&&(i={key:n,items:[]},o[n]=i),i.items.push(t)});var a=0;return this.each(o,function(t){t.$idx=a++,i.push(t),n&&n(t)}),this.sortOn(i,"key")}},{key:"has",value:function(t,e){return f.call(t,e)}},{key:"keys",value:function(t){if(m)return m(t);if(t!==Object(t))throw new TypeError("Invalid object");var e=[],n=void 0;for(n in t)this.has(t,n)&&e.push(n);return e}},{key:"loadScripts",value:function(t,e){function n(){if(r.length<=0)"function"==typeof e&&e();else{var t=r[0];r.splice(0,1),a(t,n)}}var r=void 0;this.isNull(t.length,0)<=0?"function"==typeof e&&e():("string"==typeof t&&(t=[t]),r=[].concat(t),n())}},{key:"loadIframe",value:function(t,e){var n=this.doc.createElement("iframe");if(t[0].appendChild(n),n.contentWindow)n.contentWindow.contents=e,n.src='javascript:window["contents"]';else{var r=n.contentDocument||n.document;r.open(),r.write(e),r.close()}return n}},{key:"map",value:function(t,e,n){var r=[];return null===this.isNull(t,null)?r:p&&t.map===p?t.map(e,n):(this.each(t,function(t,i,o){r.push(e.call(n,t,i,o))}),r)}},{key:"mapObject",value:function(t,e){var n={};return t&&(this.isNull(t.length,-1)<0?n[t[e]]=t:this.map(t,function(t,r){var i=t[e],o=n[i];o?("[object Array]"!==Object.prototype.toString.call(o)&&(o=[o]),o.push(t)):o=t,n[i]=o})),n}},{key:"parseQueryString",value:function(t){t=(t||"").replace("?","").replace("#","");for(var e=decodeURIComponent,n={},r=t.split("&"),i=0;i<r.length;i++){var o=r[i].split("=");n[e(o[0])]=e(o[1]||"")}return n}},{key:"request",value:function(t){var e=this;return t.headers=t.headers||{},["HEAD","GET","DELETE"].indexOf(t.method)>-1?t.data&&(t.url+=(t.url.indexOf("?")>0?"?":"&")+e.toQueryString(t.data),this.del(t,"data")):"string"!=typeof t.data&&((t.headers["Content-Type"]+"").indexOf("json")>0?t.data=JSON.stringify(t):t.data=e.toQueryString(t)),e.xhrp(t)}},{key:"slugify",value:function(t){return""===(t=t||"")?t:t=t.toLowerCase().replace(/[^0-9a-z\-\_]+/gi,"-").replace(/[\-]+/gi,"-")}},{key:"some",value:function(t,e,n){var r=!1;return e=e||function(t){return t},null===this.isNull(t,null)?r:y&&t.some===y?t.some(e,n):(this.each(t,function(t,i,o){return r||(r=e.call(n,t,i,o))?l:null}),!!r)}},{key:"sortOn",value:function(t,e){return null===this.isNull(t,null)?null:t.length<=0?[]:("string"==typeof t[0][e]?t.sort(function(t,n){return(t[e]&&t[e].toLowerCase())<(n[e]&&n[e].toLowerCase())?-1:(t[e]&&t[e].toLowerCase())>(n[e]&&n[e].toLowerCase())?1:0}):t.sort(function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}),t)}},{key:"toQueryString",value:function(t){var e="";return this.each(t,function(t,n){e+="&"+n+"="+encodeURIComponent(t)}),e.replace("&","")}},{key:"xhrp",value:function(t){var e=this;return new Promise(function(n,r){return e.xhr(t,n,r)})}},{key:"xhr",value:function(t,e,n){var r=t;"string"==typeof r&&(t=t||{},t.url=r);var i=this.getAjaxObject();return t.withCredentials&&(i.withCredentials=!0,"undefined"!=typeof XDomainRequest&&(i=new XDomainRequest)),t&&0!==t.length||n({xhr:i,error:new Error("xhr expects an url or an options object, none given.")}),t.method=t.method||"GET",i.open(t.method,t.url,i.withCredentials),this.each(t.headers||{},function(t,e){i.setRequestHeader(e,t)}),this.addEvent(i,"readystatechange",function(){4===i.readyState&&i.status>=200&&i.status<400?e({xhr:i,text:i.responseText,url:i.responseURL}):4===i.readyState&&n({xhr:i})}),this.addEvent(i,"error",function(t){n({xhr:i,error:t})}),t.nosend||i.send(t.data||void 0),i}},{key:"name",get:function(){return this._name}}]),t}();e.default=k,t.exports=e.default}])});